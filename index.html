<html>
  <head>
    <link rel="stylesheet" href="style.css">
  </head>

  <body style="background-color: lightgrey; text-align: center;">
    <h1>budget slay the spire</h1>
  </body>

  <div>
    <table id="enemies">
      <!--<tb> <button>
        slime <br>
        <img src="https://image.similarpng.com/file/similarpng/original-picture/2020/07/monster-character-Hand-drawn-on-transparent-background-PNG.png" alt="enemy" style="width: 100px; height: 100px; float: right;"> <br>
        10/10 hp <br>
      </button> </tb>-->
    </table>
  </div>

  <body>
    <table id="allies">
      <!--<tb> <button>
        player <br> 
        <img src="https://cdn2.iconfinder.com/data/icons/knight-templar-at-war/253/knight-004-512.png" alt="player" style="width: 100px; height: 100px; float: left;"> <br>
        25/25 health <br>
      </button> </tb>-->
    </table>
  </body>
  
  <body>
    <table id="deck" class="center">
      <!--<td><button> 
        slash <br>
        <img src="https://www.seekpng.com/png/detail/29-299682_black-sword-png.png" style="width: 50px; height: 50px;"> <br>
        deal 4 dmg <br>
      </button></td>-->
    </table>
  </body>

  <body>
    <button id="endTurn"> end turn </button>
  </body>

  <div id="log">
    
  </div>

  <script>
    const cEnemies = document.getElementById("enemies");
    const cAllies = document.getElementById("allies");
    const pDeck = document.getElementById("deck");
    const log = document.getElementById("log");
    const endTurn = document.getElementById("endTurn");

    const enemies = [
      slime = new Unit("slime", 10, 0, 1, new Deck(makeCopy(cards[1], card), makeCopy(cards[1], card)]), "https://image.similarpng.com/file/similarpng/original-picture/2020/07/monster-character-Hand-drawn-on-transparent-background-PNG.png")
      
    ];
    const allies = [
      knight = new Unit("knight", 25, 0, 3, new Deck(makeCopy(cards[0], card), makeCopy(cards[0], card)), "https://cdn2.iconfinder.com/data/icons/knight-templar-at-war/253/knight-004-512.png");
    ];
    const cards = [
      slash = new Card("slash", "deal 5 damage", "enemy", 1, ""),
      slime = new Card("slime", "deal 3 damage", "ally", 1, "")
    ];

    var currentEnemies = [];
    var currentAllies = [];
    var turn = true; //true = player, false = enemy
    
    class Unit {
      var name = "def";
      var image = "";
      var health = 5;
      var armor = 0;
      var deck = [];
      var energy = 1;
      
      constructor(name, health, armor, energy, deck, image) {
        this.name = name;
        this.image = image;
        this.health = health;
        this.armor = armor;
        this.deck = deck;
        this.energy = energy;
      }

      damageUnit(damage) {
        if (armor > 0) {
          if (damage > armor) {
            armor = 0;
            health -= damage - armor;
          } else {
            armor -= damage;
          }
        } else {
          health -= damage;
        }
      }
    }

    class Deck {  
      constructor(cards) {
        this.draw = cards;
      }

      drawCard() {
        if (draw.length > 0) {
          drawn = Math.random() * draw.length;
          hand.push(draw[drawn]);
          draw.splice(drawn, 1);
        }
      }

      //useCard(index, target) {
        
      //}

      reshuffle() {
        draw = [...discard];
        discard = [];
      }
    }

    class Card {
      this.name = "test";
      this.desc = "";
      this.image = "";
      this.target = "enemy";
      this.cost = 0;
      
      constructor(name, desc, target, cost, image) {
        this.name = name;
        this.desc = desc;
        this.image = image;
        this.target = target;
        this.cost = cost;
      }
    }

    class GameManager {
      static startFight() {
        var numEnemies = 1;

        for (int i = 0; i < numEnemies; i++) {
          enemy = Math.random() * enemies.length;
          currentEnemies.push(makeCopy(enemies[enemy], unit));
          updateScreen.makeUnitB(newEnemy);
        }
      }
    }

    class updateScreen {
      static makeUnitB(unit) {
        const newButton = document.createElement("button");
        const name = document.createTextNode(unit.name);
        const img = document.createElement("img");
        img.src = unit.image;
        const stats =  document.createTextNode(uni.health);
        const tbItem = document.createElement("tb"); 
        
        newButton.appendChild(name);
        newButton.appendChild(document.createElement("br"));
        newButton.appendChild(img);
        newButton.appendChild(document.createElement("br"));
        newButton.appendChild(stats);
        
        //newButton.addEventListener("click", function() {
          
        //});

        tbItem.appendChild(newButton);
        currentEnemies.appendChild(tbItem);
      }
    }

    function makeCopy(object, type) {
      if (type == "unit") {
        newObject = new Unit();
      } else if (type == "card") {
        newObject = new Card();
      }

      Object.assign(newObject, object);
      return newObject;
    }

    log.textContent += "click end turn button to start\n";
    endTurn.addEventListener("click", function() {
      if (currentAllies.length == 0) {
        currentAllies.push(makeCopy(allies[0], unit));
        updateScreen.makeUnitB(currentAllies[0]);
      } else {
        turn = turn!;
      }
    });
  </script>
</html>
